<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard</title>

  <!-- CSS utama -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css_dashboard.css') }}">
</head>
<body>
  <div class="app">
    <!-- SIDEBAR KIRI -->
    <aside class="sidebar" id="sidebar">
      <div class="sb-inner">
        <div class="brand">
          <!-- Logo -->
          <img class="brand-img"
               src="{{ url_for('static', filename='logo_neurabot.jpg') }}"
               alt="Logo Neurabot"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='grid'">

          <!-- Fallback gradient -->
          <div class="brand-logo" style="display:none" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="#07131f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2l3.5 6H8.5L12 2Z"></path>
              <path d="M12 22l-3.5-6h7L12 22Z"></path>
              <path d="M2 12l6-3.5v7L2 12Z"></path>
              <path d="M22 12l-6 3.5v-7L22 12Z"></path>
            </svg>
          </div>

          <div class="brand-name">Neurabot</div>
        </div>

        <nav class="nav" aria-label="Sidebar">
          <a class="active" href="#" data-section="dashboard">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M3 13h8V3H3zM13 21h8v-8h-8z"></path>
              <path d="M13 3h8v6h-8zM3 15h8v6H3z"></path>
            </svg>
            <span>Dashboard</span>
          </a>
          <a href="#" data-section="history">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 8v5l4 2"></path>
              <path d="M21 12A9 9 0 1 1 3 12"></path>
              <path d="M3 3v5h5"></path>
            </svg>
            <span>History</span>
          </a>
          <a href="#" data-section="settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V22a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06A2 2 0 1 1 3.27 17.9l.06-.06a1.65 1.65 0 0 0 .33-1.82A1.65 1.65 0 0 0 2 15H2a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 6.1 3.27l.06.06a1.65 1.65 0 0 0 1.82.33H8a1.65 1.65 0 0 0 1-1.51V2a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06A2 2 0 1 1 20.73 6.1l-.06.06a1.65 1.65 0 0 0-.33 1.82V8c0 .42.16.82.46 1.12.3.3.7.46 1.12.46H22a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z"></path>
            </svg>
            <span>Settings</span>
          </a>
        </nav>

        <div class="sb-footer">© 2025 Neurabot</div>
      </div>
    </aside>

    <!-- TOPBAR -->
    <header class="topbar">
      <div class="tb-wrap">
        <div class="left-group">
          <button class="hamburger" id="hamburger" aria-label="Toggle sidebar" aria-controls="sidebar" aria-expanded="false">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
          </button>
          <div class="search" role="search">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
            <input type="search" placeholder="Cari sesuatu..." aria-label="Cari"/>
          </div>
        </div>

        <div class="right-group">
          <button class="btn" id="listenBtn" aria-pressed="false" title="Mulai mendengarkan">
            <span class="dot" aria-hidden="true"></span>
            <span class="label">Start Listening</span>
          </button>
          <div class="avatar">
            <img src="https://i.pravatar.cc/64?img=12" alt="Foto profil pengguna" />
            <div class="meta">
              <div class="name">Faisal</div>
              <div class="role">Pengguna</div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- KONTEN UTAMA -->
    <main class="content" id="content">
      <div class="cards" id="dashboard-default">
        <section class="card big" id="section-title">
          <h3>Selamat Datang</h3>
          <p>Gunakan navigasi di kiri untuk berpindah halaman atau klik tombol Start Listening untuk memulai.</p>
        </section>
      </div>

      <!-- Kontainer halaman voice -->
      <div id="voice-container" style="display:none; width:100%; height:calc(100vh - 120px);">
        <iframe
          id="voice-iframe"
          src="/voice"
          title="Voice to Text"
          style="width:100%; height:100%; border:0; border-radius:14px; background:#0b1622;">
        </iframe>
      </div>
    </main>
  </div>

  <script>
    // Toggle sidebar (mobile)
    const sidebar = document.getElementById('sidebar');
    const hamburger = document.getElementById('hamburger');
    hamburger?.addEventListener('click', () => {
      const isOpen = sidebar.classList.toggle('open');
      hamburger.setAttribute('aria-expanded', String(isOpen));
    });

    // Start/Stop Listening → tampilkan/sembyikan halaman voice
    const listenBtn = document.getElementById('listenBtn');
    const dashDefault = document.getElementById('dashboard-default');
    const voiceWrap = document.getElementById('voice-container');

    let listening = false;
    let pulseEl = null;

    listenBtn.addEventListener('click', () => {
      listening = !listening;
      listenBtn.setAttribute('aria-pressed', String(listening));
      listenBtn.querySelector('.label').textContent = listening ? 'Stop Listening' : 'Start Listening';

      if (listening) {
        pulseEl = document.createElement('span');
        pulseEl.className = 'pulse';
        pulseEl.setAttribute('aria-hidden','true');
        listenBtn.prepend(pulseEl);
      } else if (pulseEl) {
        pulseEl.remove();
        pulseEl = null;
      }

      if (listening) {
        dashDefault.style.display = 'none';
        voiceWrap.style.display = 'block';
      } else {
        voiceWrap.style.display = 'none';
        dashDefault.style.display = '';
      }
    });
  </script>
</body>
</html>
